!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["parse-xml"]=t():e.parseXml=t()}("undefined"==typeof self?this:self,(function(){return(()=>{"use strict";var e={138:(e,t,n)=>{const s=n(567),r=n(12),i=n(190),o=n(315),c=n(914),a=n(526),h=n(141),u=n(684);function l(e,t){return new s(e,t).document}l.XmlCdata=r,l.XmlComment=i,l.XmlDocument=o,l.XmlElement=c,l.XmlNode=a,l.XmlProcessingInstruction=h,l.XmlText=u,e.exports=l},567:(e,t,n)=>{const s=n(444),r=n(531),i=n(12),o=n(190),c=n(315),a=n(914),h=n(141),u=n(684);e.exports=class{constructor(e,t={}){for(this.document=new c,this.currentNode=this.document,this.options=t,this.scanner=new s(function(e){return"\ufeff"===e[0]&&(e=e.slice(1)),e.replace(/\r\n?/g,"\n")}(e)),this.consumeProlog(),this.consumeElement()||this.error("Root element is missing or invalid");this.consumeMisc(););this.scanner.isEnd||this.error("Extra content at the end of the document")}addNode(e){e.parent=this.currentNode,this.currentNode.children.push(e)}addText(e){let{children:t}=this.currentNode;if(t.length>0){let n=t[t.length-1];if(n instanceof u)return void(n.text+=e)}this.addNode(new u(e))}consumeAttributeValue(){let e,{scanner:t}=this,n=t.peek();if('"'!==n&&"'"!==n)return!1;t.advance();let s=!1,r="",i='"'===n?/[^"&<]+/y:/[^'&<]+/y;e:for(;!t.isEnd;)switch(e=t.consumeMatch(i),e&&(this.validateChars(e),r+=e.replace(/[\t\r\n]/g," ")),t.peek()){case n:s=!0;break e;case"&":r+=this.consumeReference();continue;case"<":this.error("Unescaped `<` is not allowed in an attribute value");break;case"":this.error("Unclosed attribute")}return s||this.error("Unclosed attribute"),t.advance(),r}consumeCdataSection(){let{scanner:e}=this;if(!e.consumeStringFast("<![CDATA["))return!1;let t=e.consumeUntilString("]]>");return this.validateChars(t),e.consumeStringFast("]]>")||this.error("Unclosed CDATA section"),this.options.preserveCdata?this.addNode(new i(t)):this.addText(t),!0}consumeCharData(){let{scanner:e}=this,t=e.consumeUntilMatch(/<|&|]]>/g);return!!t&&(this.validateChars(t),"]"===e.peek()&&"]]>"===e.peek(3)&&this.error("Element content may not contain the CDATA section close delimiter `]]>`"),this.addText(t),!0)}consumeComment(){let{scanner:e}=this;if(!e.consumeStringFast("\x3c!--"))return!1;let t=e.consumeUntilString("--");return this.validateChars(t),e.consumeStringFast("--\x3e")||("--"===e.peek(2)?this.error("The string `--` isn't allowed inside a comment"):this.error("Unclosed comment")),this.options.preserveComments&&this.addNode(new o(t.trim())),!0}consumeContentReference(){let e=this.consumeReference();return!!e&&(this.addText(e),!0)}consumeDoctypeDeclaration(){let{scanner:e}=this;return!(!e.consumeStringFast("<!DOCTYPE")||!this.consumeWhitespace()||(e.consumeMatch(/[^[>]+/y),e.consumeMatch(/\[[\s\S]+?\][\x20\t\r\n]*>/y)||e.consumeStringFast(">")||this.error("Unclosed doctype declaration"),0))}consumeElement(){let{scanner:e}=this,t=e.charIndex;if("<"!==e.peek())return!1;e.advance();let n=this.consumeName();if(!n)return e.reset(t),!1;let s=Object.create(null);for(;this.consumeWhitespace();){let e=this.consumeName();if(!e)continue;let t=this.consumeEqual()&&this.consumeAttributeValue();!1===t&&this.error("Attribute value expected"),e in s&&this.error(`Duplicate attribute: ${e}`),"xml:space"===e&&"default"!==t&&"preserve"!==t&&this.error('Value of the `xml:space` attribute must be "default" or "preserve"'),s[e]=t}if(this.options.sortAttributes){let e=Object.keys(s).sort(),t=Object.create(null);for(let n=0;n<e.length;++n){let r=e[n];t[r]=s[r]}s=t}let r=Boolean(e.consumeStringFast("/>")),i=new a(n,s);if(i.parent=this.currentNode,!r){for(e.consumeStringFast(">")||this.error(`Unclosed start tag for element \`${n}\``),this.currentNode=i,this.consumeCharData();this.consumeElement()||this.consumeContentReference()||this.consumeCdataSection()||this.consumeProcessingInstruction()||this.consumeComment();)this.consumeCharData();let t,s=e.charIndex;e.consumeStringFast("</")&&(t=this.consumeName())&&t===n||(e.reset(s),this.error(`Missing end tag for element ${n}`)),this.consumeWhitespace(),e.consumeStringFast(">")||this.error(`Unclosed end tag for element ${n}`),this.currentNode=i.parent}return this.addNode(i),!0}consumeEqual(){return this.consumeWhitespace(),!!this.scanner.consumeStringFast("=")&&(this.consumeWhitespace(),!0)}consumeMisc(){return this.consumeComment()||this.consumeProcessingInstruction()||this.consumeWhitespace()}consumeName(){return r.isNameStartChar(this.scanner.peek())?this.scanner.consumeMatchFn(r.isNameChar):""}consumeProcessingInstruction(){let{scanner:e}=this,t=e.charIndex;if(!e.consumeStringFast("<?"))return!1;let n=this.consumeName();if(n?"xml"===n.toLowerCase()&&(e.reset(t),this.error("XML declaration isn't allowed here")):this.error("Invalid processing instruction"),!this.consumeWhitespace()){if(e.consumeStringFast("?>"))return this.addNode(new h(n)),!0;this.error("Whitespace is required after a processing instruction name")}let s=e.consumeUntilString("?>");return this.validateChars(s),e.consumeStringFast("?>")||this.error("Unterminated processing instruction"),this.addNode(new h(n,s)),!0}consumeProlog(){let{scanner:e}=this,t=e.charIndex;for(this.consumeXmlDeclaration();this.consumeMisc(););if(this.consumeDoctypeDeclaration())for(;this.consumeMisc(););return t<e.charIndex}consumeReference(){let{scanner:e}=this;if("&"!==e.peek())return!1;e.advance();let t,n=e.consumeMatchFn(r.isReferenceChar);if(";"!==e.consume()&&this.error("Unterminated reference (a reference must end with `;`)"),"#"===n[0]){let e="x"===n[1]?parseInt(n.slice(2),16):parseInt(n.slice(1),10);isNaN(e)&&this.error("Invalid character reference"),t=String.fromCodePoint(e),r.isXmlChar(t)||this.error("Character reference resolves to an invalid character")}else if(t=r.predefinedEntities[n],void 0===t){let{ignoreUndefinedEntities:t,resolveUndefinedEntity:s}=this.options,r=`&${n};`;if(s){let e=s(r);if(null!=e){let t=typeof e;if("string"!==t)throw new TypeError(`\`resolveUndefinedEntity()\` must return a string, \`null\`, or \`undefined\`, but returned a value of type ${t}`);return e}}if(t)return r;e.reset(-r.length),this.error(`Named entity isn't defined: ${r}`)}return t}consumeSystemLiteral(){let{scanner:e}=this,t=e.consumeStringFast('"')||e.consumeStringFast("'");if(!t)return!1;let n=e.consumeUntilString(t);return this.validateChars(n),e.consumeStringFast(t)||this.error("Missing end quote"),n}consumeWhitespace(){return Boolean(this.scanner.consumeMatchFn(r.isWhitespace))}consumeXmlDeclaration(){let{scanner:e}=this;if(!e.consumeStringFast("<?xml"))return!1;this.consumeWhitespace()||this.error("Invalid XML declaration");let t=Boolean(e.consumeStringFast("version"))&&this.consumeEqual()&&this.consumeSystemLiteral();if(!1===t?this.error("XML version is missing or invalid"):/^1\.[0-9]+$/.test(t)||this.error("Invalid character in version number"),this.consumeWhitespace()){Boolean(e.consumeStringFast("encoding"))&&this.consumeEqual()&&this.consumeSystemLiteral()&&this.consumeWhitespace();let t=Boolean(e.consumeStringFast("standalone"))&&this.consumeEqual()&&this.consumeSystemLiteral();t&&("yes"!==t&&"no"!==t&&this.error('Only "yes" and "no" are permitted as values of `standalone`'),this.consumeWhitespace())}return e.consumeStringFast("?>")||this.error("Invalid or unclosed XML declaration"),!0}error(e){let{charIndex:t,string:n}=this.scanner,s=1,r="",i=1;for(let e=0;e<t;++e){let t=n[e];"\n"===t?(s=1,r="",i+=1):(s+=1,r+=t)}let o=n.indexOf("\n",t);r+=-1===o?n.slice(t):n.slice(t,o);let c=0;r.length>50&&(s<40?r=r.slice(0,50):(c=s-20,r=r.slice(c,s+30)));let a=new Error(`${e} (line ${i}, column ${s})\n  ${r}\n`+" ".repeat(s-c+1)+"^\n");throw Object.assign(a,{column:s,excerpt:r,line:i,pos:t}),a}validateChars(e){let t=0;for(let n of e)r.isNotXmlChar(n)&&(this.scanner.reset(-([...e].length-t)),this.error("Invalid character")),t+=1}}},444:e=>{const t="";e.exports=class{constructor(e){this.chars=[...e],this.charCount=this.chars.length,this.charIndex=0,this.charsToBytes=new Array(this.charCount),this.multiByteMode=!1,this.string=e;let{chars:t,charCount:n,charsToBytes:s}=this;if(n===e.length)for(let e=0;e<n;++e)s[e]=e;else{for(let e=0,r=0;r<n;++r)s[r]=e,e+=t[r].length;this.multiByteMode=!0}}get isEnd(){return this.charIndex>=this.charCount}_charLength(e){let{length:t}=e;return t<2||!this.multiByteMode?t:e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length}advance(e=1){this.charIndex=Math.min(this.charCount,this.charIndex+e)}consume(e=1){let t=this.peek(e);return this.advance(e),t}consumeMatch(e){if(!e.sticky)throw new Error('`regex` must have a sticky flag ("y")');e.lastIndex=this.charsToBytes[this.charIndex];let n=e.exec(this.string);if(null===n)return t;let s=n[0];return this.advance(this._charLength(s)),s}consumeMatchFn(e){let n=this.charIndex;for(;!this.isEnd&&e(this.peek());)this.advance();return this.charIndex>n?this.string.slice(this.charsToBytes[n],this.charsToBytes[this.charIndex]):t}consumeString(e){if(this.consumeStringFast(e))return e;if(!this.multiByteMode)return t;let{length:n}=e,s=this._charLength(e);return s!==n&&e===this.peek(s)?(this.advance(s),e):t}consumeStringFast(e){if(this.peek()===e[0]){let{length:t}=e;if(1===t)return this.advance(),e;if(this.peek(t)===e)return this.advance(t),e}return t}consumeUntilMatch(e){if(!e.global)throw new Error('`regex` must have a global flag ("g")');let n=this.charsToBytes[this.charIndex];e.lastIndex=n;let s=e.exec(this.string);if(null===s||s.index===n)return t;let r=this.string.slice(n,s.index);return this.advance(this._charLength(r)),r}consumeUntilString(e){let{charIndex:n,charsToBytes:s,string:r}=this,i=s[n],o=r.indexOf(e,i);if(o<=0)return t;let c=r.slice(i,o);return this.advance(this._charLength(c)),c}peek(e=1){if(this.charIndex>=this.charCount)return t;if(1===e)return this.chars[this.charIndex];let{charsToBytes:n,charIndex:s}=this;return this.string.slice(n[s],n[s+e])}reset(e=0){this.charIndex=e>=0?Math.min(this.charCount,e):Math.max(0,this.charIndex+e)}}},12:(e,t,n)=>{const s=n(526),r=n(684);e.exports=class extends r{get type(){return s.TYPE_CDATA}}},190:(e,t,n)=>{const s=n(526);e.exports=class extends s{constructor(e=""){super(),this.content=e}get type(){return s.TYPE_COMMENT}toJSON(){return Object.assign(s.prototype.toJSON.call(this),{content:this.content})}}},315:(e,t,n)=>{const s=n(914),r=n(526);e.exports=class extends r{constructor(e=[]){super(),this.children=e}get document(){return this}get root(){return this.children.find((e=>e instanceof s))||null}get text(){return this.children.map((e=>"text"in e?e.text:"")).join("")}get type(){return r.TYPE_DOCUMENT}toJSON(){return Object.assign(r.prototype.toJSON.call(this),{children:this.children.map((e=>e.toJSON()))})}}},914:(e,t,n)=>{const s=n(526);class r extends s{constructor(e,t=Object.create(null),n=[]){super(),this.name=e,this.attributes=t,this.children=n}get isEmpty(){return 0===this.children.length}get preserveWhitespace(){let e=this;for(;e instanceof r;){if("xml:space"in e.attributes)return"preserve"===e.attributes["xml:space"];e=e.parent}return!1}get text(){return this.children.map((e=>"text"in e?e.text:"")).join("")}get type(){return s.TYPE_ELEMENT}toJSON(){return Object.assign(s.prototype.toJSON.call(this),{name:this.name,attributes:this.attributes,children:this.children.map((e=>e.toJSON()))})}}e.exports=r},526:e=>{class t{constructor(){this.parent=null}get document(){return this.parent?this.parent.document:null}get isRootNode(){return!!this.parent&&this.parent===this.document}get preserveWhitespace(){return Boolean(this.parent&&this.parent.preserveWhitespace)}get type(){return""}toJSON(){let e={type:this.type};return this.isRootNode&&(e.isRootNode=!0),this.preserveWhitespace&&(e.preserveWhitespace=!0),e}}t.TYPE_CDATA="cdata",t.TYPE_COMMENT="comment",t.TYPE_DOCUMENT="document",t.TYPE_ELEMENT="element",t.TYPE_PROCESSING_INSTRUCTION="pi",t.TYPE_TEXT="text",e.exports=t},141:(e,t,n)=>{const s=n(526);e.exports=class extends s{constructor(e,t=""){super(),this.name=e,this.content=t}get type(){return s.TYPE_PROCESSING_INSTRUCTION}toJSON(){return Object.assign(s.prototype.toJSON.call(this),{name:this.name,content:this.content})}}},684:(e,t,n)=>{const s=n(526);e.exports=class extends s{constructor(e=""){super(),this.text=e}get type(){return s.TYPE_TEXT}toJSON(){return Object.assign(s.prototype.toJSON.call(this),{text:this.text})}}},531:(e,t)=>{const n=Object.freeze(Object.assign(Object.create(null),{amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}));function s(e){if(r(e))return!0;let t=o(e);return 45===t||46===t||t>=48&&t<=57||183===t||t>=768&&t<=879||t>=8255&&t<=8256}function r(e){let t=o(e);return 58===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}function i(e){let t=o(e);return 9===t||10===t||13===t||t>=32&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111}function o(e){return e.codePointAt(0)||-1}t.predefinedEntities=n,t.isNameChar=s,t.isNameStartChar=r,t.isNotXmlChar=function(e){return!i(e)},t.isReferenceChar=function(e){return"#"===e||s(e)},t.isWhitespace=function(e){let t=o(e);return 32===t||9===t||10===t||13===t},t.isXmlChar=i}},t={};return function n(s){if(t[s])return t[s].exports;var r=t[s]={exports:{}};return e[s](r,r.exports,n),r.exports}(138)})()}));
//# sourceMappingURL=parse-xml.min.js.map